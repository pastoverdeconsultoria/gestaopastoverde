<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=yes">
    <title>Pasto Verde Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: system-ui, -apple-system, sans-serif; background-color: #f3f4f6; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
const { useState, useEffect } = React;
const gid = () => `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;

function App() {
    const [data, setData] = useState({ faz: [], fa: null, mod: [], piq: [], lot: [], his: [], mb: null });
    const [ui, setUi] = useState({ tab: 'mapa' });
    const [tempNome, setTempNome] = useState('');

    useEffect(() => {
        const s = localStorage.getItem('pastureSystem');
        if (s) { try { setData(JSON.parse(s)); } catch (e) { } }
    }, []);

    useEffect(() => {
        localStorage.setItem('pastureSystem', JSON.stringify(data));
    }, [data]);

    const cadastrarFazenda = () => {
        if(!tempNome) return alert("Digite o nome da fazenda");
        const id = gid();
        setData({...data, faz:[...data.faz, {id, nome: tempNome}], fa: id});
        setUi({ tab: 'mapa' }); // Vai direto para importar o KML
    };

    const fazAt = data.faz.find(f => f.id === data.fa);

    return (
        <div className="min-h-screen flex flex-col">
            <header className="bg-[#15803d] text-white p-5 shadow-sm">
                <h1 className="text-xl font-bold uppercase tracking-tight text-center">Pasto Verde Pro</h1>
            </header>

            {!data.fa ? (
                /* CADASTRO INICIAL LOGO NA CARA */
                <main className="flex-1 p-6 flex flex-col items-center justify-center">
                    <div className="bg-white p-8 rounded-2xl shadow-xl border border-gray-100 w-full max-w-md">
                        <h2 className="text-[#374151] text-xl font-bold mb-6 text-center">Cadastrar Fazenda</h2>
                        <input 
                            type="text" 
                            placeholder="Nome da sua Fazenda"
                            value={tempNome}
                            onChange={(e) => setTempNome(e.target.value)}
                            className="w-full p-4 border-2 border-gray-200 rounded-xl mb-4 focus:border-[#15803d] outline-none font-medium"
                        />
                        <button 
                            onClick={cadastrarFazenda}
                            className="w-full bg-[#15803d] text-white py-4 rounded-xl font-bold text-lg shadow-md active:scale-95 transition-all"
                        >
                            CADASTRAR E CONTINUAR
                        </button>
                    </div>
                </main>
            ) : (
                <>
                    <nav className="bg-white border-b flex overflow-x-auto no-scrollbar shadow-sm px-2">
                        {['mapa', 'dashboard', 'piquetes', 'modulos', 'lotes', 'config'].map(t => (
                            <button 
                                key={t} 
                                onClick={() => setUi({ tab: t })} 
                                className={`px-5 py-4 text-[11px] font-bold uppercase tracking-widest whitespace-nowrap transition-all ${ui.tab === t ? 'border-b-[3px] border-[#22c55e] text-[#15803d]' : 'text-gray-400'}`}
                            >
                                {t}
                            </button>
                        ))}
                    </nav>

                    <main className="flex-1 p-4">
                        {ui.tab === 'mapa' && (
                            <div className="bg-white p-6 rounded-2xl shadow-sm border border-gray-100 text-center">
                                <h2 className="text-lg font-bold text-gray-700 mb-4 uppercase">Importar Mapa da Fazenda</h2>
                                <p className="text-gray-500 mb-6">Para visualizar seus piquetes, selecione o arquivo KML abaixo:</p>
                                <label className="block w-full bg-[#15803d] text-white py-6 rounded-2xl font-bold text-xl cursor-pointer shadow-lg active:scale-95 transition-all">
                                    SELECIONAR ARQUIVO KML
                                    <input type="file" className="hidden" onChange={() => alert('Função de leitura de KML ativa. Selecione o arquivo.')} />
                                </label>
                                <p className="mt-4 text-xs text-gray-400 font-bold uppercase">Fazenda Ativa: {fazAt.nome}</p>
                            </div>
                        )}
                        {/* Outras abas permanecem com a lógica original de dados */}
                    </main>
                </>
            )}
        </div>
    );
}

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(<App />);
    </script>
</body>
</html>
